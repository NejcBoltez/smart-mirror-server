{% extends 'Dashboard.html' %} {% block content %}
<script>
    window.onload = function() {
        setInterval(updateTime, 1000);
        setInterval(getSpeedTest, 1000);

    };

    function updateTime() {
        const d = new Date();
        const timeText = d.getHours() + ":" + d.getMinutes() + ":" + d.getSeconds();
        const dateText = d.getDate() + "/" + parseInt(parseInt(d.getUTCMonth()) + 1) + "/" + d.getFullYear();
        document.getElementsByClassName("clock")[0].textContent = timeText;
        document.getElementsByClassName("day")[0].textContent = d.getDate();
        document.getElementsByClassName("monthYear")[0].textContent = parseInt(parseInt(d.getUTCMonth()) + 1) + "/" + d.getFullYear();
    }
    async function getSpeedTest() {
        let startTime, endTime;
        let kboutput = document.getElementsByClassName("kbs")[0];
        let mboutput = document.getElementsByClassName("mbs")[0];
        let urlForTesting = "https://source.unsplash.com/random?topics=natur"
        console.log(urlForTesting)
        startTime = new Date().getTime();
        await fetch(urlForTesting).then((response) => {
            endTime = new Date().getTime();
            console.log("endTime: " + endTime)
            console.log("startTime: " + startTime)
            console.log(endTime - startTime)
            imageSize = response.headers.get("content-length");
            let timeDuration = (endTime - startTime) / 1000;
            let loadedBits = imageSize * 8;
            console.log(loadedBits)
            console.log(timeDuration)
            let speedInBps = (loadedBits / timeDuration).toFixed(2);
            let speedInKbps = (speedInBps / 1024).toFixed(2);
            let speedInMbps = (speedInKbps / 1024).toFixed(2);
            console.log(speedInKbps)
            document.getElementsByClassName("kbs")[0].textContent = speedInKbps + " Kbs"
            document.getElementsByClassName("mbs")[0].textContent = speedInMbps + " Mbs"
        });
    }
</script>
<div class="top">
    <span style="float: left;" class="kbs"></span>
    <span style="float: right;" class="mbs"></span>
</div>
<div class="content">
    <div class="dashboardItem">
        <p class="calendar"></p>

        <p class="day"></p>

        <p class="monthYear"></p>
    </div>
    <div class="dashboardItem">
        <div>
            <p class="clock"></p>
        </div>
    </div>
    <div class="dashboardItem">
        <div class="weather">
            <div>
                <p>TEMP: {{weatherData.main.temp}}</p>
                <p>MIN TEMP: {{weatherData.main.temp_min}}</p>
                <p>MAX TEMP: {{weatherData.main.temp_max}}</p>
                <p>HUMIDITY: {{weatherData.main.humidity}}</p>
            </div>
        </div>
    </div>
</div>
<div class="bottom">
    <div class="soundGraph"></div>
</div>
{% endblock %}